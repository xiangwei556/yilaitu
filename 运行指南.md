# 易可图项目运行指南

本指南提供了如何运行易可图项目的前端和后端服务的详细步骤。

## 目录
1. [环境准备](#环境准备)
2. [后端服务运行](#后端服务运行)
3. [前端服务运行](#前端服务运行)
4. [API接口说明](#api接口说明)
5. [常见问题](#常见问题)

## 环境准备

### 1. Python环境
- 已安装uv包管理器
- 后端使用FastAPI框架

### 2. Node.js环境
- 推荐使用Node.js 16.x或更高版本
- npm或yarn包管理器

## 后端服务运行

### 1. 安装依赖
```bash
# 使用uv安装后端依赖
cd backend
uv pip install -r requirements.txt
```

### 2. 配置环境变量（可选）
如果需要配置TOS存储和ARK API，可以创建.env文件：
```
# TOS配置
TOS_ACCESS_KEY=your_access_key
TOS_SECRET_KEY=your_secret_key
TOS_ENDPOINT=tos-cn-guangzhou.volces.com
TOS_REGION=cn-guangzhou
TOS_BUCKET=image-edit-hsyq

# ARK API配置
ARK_API_KEY=your_ark_api_key
```

### 3. 启动后端服务
```bash
# 在backend目录下执行
python main.py
# 或使用uv
uv run main.py
```

服务将在 http://localhost:8001 启动。

## 前端服务运行

### 1. 安装依赖
```bash
cd frontend
npm install
```

### 2. 启动前端开发服务器
```bash
npm run dev
```

前端服务将在 http://localhost:3000 启动。

### 3. 构建生产版本
```bash
npm run build
```

构建后的文件将在 `dist` 目录中。

## API接口说明

### 主要接口

#### 1. 图片处理接口
- URL: `/api/process-image`
- 方法: POST
- 参数:
  - `file`: 上传的图片文件
  - `width`: 画布宽度（默认800）
  - `height`: 画布高度（默认600）
  - `background_type`: 背景类型（默认'white'）
- 返回: 处理后的图片URL和相关信息

#### 2. 健康检查接口
- URL: `/health`
- 方法: GET
- 返回: 服务健康状态

## 常见问题

### 1. 后端启动失败
- 检查依赖是否正确安装
- 检查端口8001是否被占用
- 查看错误日志获取详细信息

### 2. 前端API调用失败
- 确保后端服务已启动
- 检查Vite配置中的代理设置
- 确认API路径正确

### 3. TOS存储上传失败
- 检查TOS配置是否正确
- 确保访问密钥有效
- 查看tos_error.log获取详细错误信息